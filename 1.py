
def iou(box1, box2):
    """Функция рассчитывает метрику IoU и проверяет пересечение прямоугольников"""
    flag = True
    ax1, ay1, ax2, ay2 = box1[0][0], box1[1][0], box1[1][0], box1[1][1]  # box
    bx1, by1, bx2, by2 = box2[0][0], box2[0][1], box2[1][0], box2[1][1] # box_rail_lines
    if ax1 < bx2 and ax2 > bx1 and ay1 < by2 and ay2 > by1:
        print("пересекаются")
    else:
        print("не пересекаются")


prediction_boxes = [((745, 5), (866, 132)), ((956, 308), (1024, 408)), ((307, 52), (368, 114)), ((843, 8), (930, 81)), ((915, 141), (1024, 244)), ((637, 16), (725, 79)), ((1, 68), (78, 159)), ((773, 10), (865, 83)), ((854, 334), (1022, 498)), ((567, 20), (657, 86)), ((441, 27), (522, 96)), ((0, 246), (138, 374)), ((795, 133), (959, 231)), ((0, 411), (142, 564)), ((445, 155), (642, 314)), ((126, 230), (272, 358)), ((420, 361), (646, 529)), ((288, 374), (485, 538)), ((122, 370), (309, 549)), ((637, 157), (795, 266)), ((706, 345), (949, 513)), ((236, 223), (402, 347)), ((701, 132), (850, 237)), ((551, 337), (742, 481)), ((341, 189), (496, 309))]

iou(prediction_boxes[8], prediction_boxes[20])